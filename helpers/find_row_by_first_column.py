def find_row_by_first_column(ws, target_text, start_row=1, end_row=None):
    """
    Ищет первую строку на листе Excel, в которой значение первой ячейки (колонка A)
    содержит указанный текст.

    Поиск производится в заданном диапазоне строк. Если значение ячейки в первой
    колонке является строкой и искомый текст `target_text` присутствует в этой
    строке (как подстрока, с учетом регистра), функция возвращает номер этой строки.

    Args:
        ws (openpyxl.worksheet.worksheet.Worksheet): Лист Excel (объект openpyxl),
            на котором производится поиск.
        target_text (str): Текст, который необходимо найти в первой колонке.
        start_row (int, optional): Номер строки, с которой начинается поиск (1-индексация).
            По умолчанию равен 1.
        end_row (int, optional): Номер строки, на которой заканчивается поиск (включительно).
            По умолчанию равен максимальному количеству строк на листе (`ws.max_row`).

    Returns:
        int | None: Номер первой строки (1-индексация), удовлетворяющей условиям поиска.
                    Возвращает `None`, если такая строка не найдена в указанном диапазоне.
    
    Пример:
        Если в ячейке A5 листа `ws` находится текст "Пример текста для поиска",
        то вызов `find_row_by_first_column(ws, "текста для")` вернет `5`.
    """
    if end_row is None:
        end_row = ws.max_row  # Определяем последнюю строку для поиска, если она не задана

    # Итерируемся по строкам в указанном диапазоне
    for row_index in range(start_row, end_row + 1):
        cell_value = ws.cell(row=row_index, column=1).value  # Получаем значение ячейки в первой колонке

        # Проверяем, является ли значение ячейки строкой и содержит ли оно target_text
        if isinstance(cell_value, str) and target_text in cell_value:
            return row_index  # Возвращаем номер строки, если условие выполнено
            
    return None  # Возвращаем None, если ничего не найдено